<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Go语言快速入门 | Wallace&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="记录个人修行中的点滴">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.f7eaaecd.css" as="style"><link rel="preload" href="/assets/js/app.c3dada13.js" as="script"><link rel="preload" href="/assets/js/3.113ae115.js" as="script"><link rel="preload" href="/assets/js/1.24f57cb6.js" as="script"><link rel="preload" href="/assets/js/13.23b7834b.js" as="script"><link rel="prefetch" href="/assets/js/10.cea410fe.js"><link rel="prefetch" href="/assets/js/100.a7a53a73.js"><link rel="prefetch" href="/assets/js/101.5bc41419.js"><link rel="prefetch" href="/assets/js/102.015ded9b.js"><link rel="prefetch" href="/assets/js/103.f1983baf.js"><link rel="prefetch" href="/assets/js/104.5a9283bb.js"><link rel="prefetch" href="/assets/js/105.2db5299f.js"><link rel="prefetch" href="/assets/js/106.b964abdd.js"><link rel="prefetch" href="/assets/js/107.6fd0d8bc.js"><link rel="prefetch" href="/assets/js/108.2d8d2698.js"><link rel="prefetch" href="/assets/js/109.10e96e09.js"><link rel="prefetch" href="/assets/js/11.070a2bb7.js"><link rel="prefetch" href="/assets/js/110.e17c5171.js"><link rel="prefetch" href="/assets/js/111.ab01fc77.js"><link rel="prefetch" href="/assets/js/112.061d929b.js"><link rel="prefetch" href="/assets/js/113.c3352ca7.js"><link rel="prefetch" href="/assets/js/114.0b0279f8.js"><link rel="prefetch" href="/assets/js/115.89acb09d.js"><link rel="prefetch" href="/assets/js/116.30599fc5.js"><link rel="prefetch" href="/assets/js/117.6dbe04c3.js"><link rel="prefetch" href="/assets/js/118.1622a349.js"><link rel="prefetch" href="/assets/js/119.d276cb99.js"><link rel="prefetch" href="/assets/js/12.ef94bac0.js"><link rel="prefetch" href="/assets/js/120.55de9008.js"><link rel="prefetch" href="/assets/js/121.388bb202.js"><link rel="prefetch" href="/assets/js/122.5d721df9.js"><link rel="prefetch" href="/assets/js/123.6151dbd8.js"><link rel="prefetch" href="/assets/js/124.d7f670f3.js"><link rel="prefetch" href="/assets/js/125.02ce9f54.js"><link rel="prefetch" href="/assets/js/126.57bd5f57.js"><link rel="prefetch" href="/assets/js/127.2d4aa5d9.js"><link rel="prefetch" href="/assets/js/128.569b2fdc.js"><link rel="prefetch" href="/assets/js/129.89bacca9.js"><link rel="prefetch" href="/assets/js/130.cf2ec62c.js"><link rel="prefetch" href="/assets/js/131.3a2b3280.js"><link rel="prefetch" href="/assets/js/132.c01c6960.js"><link rel="prefetch" href="/assets/js/133.0472ee2a.js"><link rel="prefetch" href="/assets/js/134.480122d5.js"><link rel="prefetch" href="/assets/js/135.6104f370.js"><link rel="prefetch" href="/assets/js/136.cd9f16d8.js"><link rel="prefetch" href="/assets/js/137.2800ad31.js"><link rel="prefetch" href="/assets/js/138.ca80a594.js"><link rel="prefetch" href="/assets/js/139.f98fd758.js"><link rel="prefetch" href="/assets/js/14.bcf064a5.js"><link rel="prefetch" href="/assets/js/140.31eb4c38.js"><link rel="prefetch" href="/assets/js/141.72fb5ea8.js"><link rel="prefetch" href="/assets/js/142.476cb71d.js"><link rel="prefetch" href="/assets/js/143.65e60d09.js"><link rel="prefetch" href="/assets/js/144.c8ac8f0c.js"><link rel="prefetch" href="/assets/js/145.9ae65ef8.js"><link rel="prefetch" href="/assets/js/146.35df5536.js"><link rel="prefetch" href="/assets/js/147.fdf74a13.js"><link rel="prefetch" href="/assets/js/148.c884ca76.js"><link rel="prefetch" href="/assets/js/149.eb0586e3.js"><link rel="prefetch" href="/assets/js/15.002a59f0.js"><link rel="prefetch" href="/assets/js/150.946f12df.js"><link rel="prefetch" href="/assets/js/151.8d114df7.js"><link rel="prefetch" href="/assets/js/152.773b8485.js"><link rel="prefetch" href="/assets/js/153.268e0f46.js"><link rel="prefetch" href="/assets/js/154.54c74cf6.js"><link rel="prefetch" href="/assets/js/16.999094e9.js"><link rel="prefetch" href="/assets/js/17.52707c87.js"><link rel="prefetch" href="/assets/js/18.9108e4cd.js"><link rel="prefetch" href="/assets/js/19.56153de7.js"><link rel="prefetch" href="/assets/js/20.b95f1516.js"><link rel="prefetch" href="/assets/js/21.df0eda7c.js"><link rel="prefetch" href="/assets/js/22.11612069.js"><link rel="prefetch" href="/assets/js/23.25640d0b.js"><link rel="prefetch" href="/assets/js/24.e6cb6881.js"><link rel="prefetch" href="/assets/js/25.3db0d85c.js"><link rel="prefetch" href="/assets/js/26.1833dee9.js"><link rel="prefetch" href="/assets/js/27.5032fc20.js"><link rel="prefetch" href="/assets/js/28.6054f6a7.js"><link rel="prefetch" href="/assets/js/29.7c10cb64.js"><link rel="prefetch" href="/assets/js/30.b971fd4a.js"><link rel="prefetch" href="/assets/js/31.46a7057e.js"><link rel="prefetch" href="/assets/js/32.35464b59.js"><link rel="prefetch" href="/assets/js/33.9a683b2c.js"><link rel="prefetch" href="/assets/js/34.09fe3f0f.js"><link rel="prefetch" href="/assets/js/35.b47dab30.js"><link rel="prefetch" href="/assets/js/36.5b982f08.js"><link rel="prefetch" href="/assets/js/37.8f1854e1.js"><link rel="prefetch" href="/assets/js/38.da746968.js"><link rel="prefetch" href="/assets/js/39.71c4f3fd.js"><link rel="prefetch" href="/assets/js/4.e88e52ab.js"><link rel="prefetch" href="/assets/js/40.5309c411.js"><link rel="prefetch" href="/assets/js/41.ee8a3d2f.js"><link rel="prefetch" href="/assets/js/42.b15ba90d.js"><link rel="prefetch" href="/assets/js/43.de7bdba1.js"><link rel="prefetch" href="/assets/js/44.5d545c80.js"><link rel="prefetch" href="/assets/js/45.b6fd882d.js"><link rel="prefetch" href="/assets/js/46.d113712b.js"><link rel="prefetch" href="/assets/js/47.313846e1.js"><link rel="prefetch" href="/assets/js/48.003a18e7.js"><link rel="prefetch" href="/assets/js/49.93a910ea.js"><link rel="prefetch" href="/assets/js/5.a485daaf.js"><link rel="prefetch" href="/assets/js/50.2a8fa0b8.js"><link rel="prefetch" href="/assets/js/51.56666bdb.js"><link rel="prefetch" href="/assets/js/52.e1bcd478.js"><link rel="prefetch" href="/assets/js/53.b93b3ec3.js"><link rel="prefetch" href="/assets/js/54.cf4130c8.js"><link rel="prefetch" href="/assets/js/55.ebe28b0f.js"><link rel="prefetch" href="/assets/js/56.f8b146c6.js"><link rel="prefetch" href="/assets/js/57.a382130b.js"><link rel="prefetch" href="/assets/js/58.5734e585.js"><link rel="prefetch" href="/assets/js/59.2ab32862.js"><link rel="prefetch" href="/assets/js/6.16c6b7ad.js"><link rel="prefetch" href="/assets/js/60.d07b9ed3.js"><link rel="prefetch" href="/assets/js/61.b75d3711.js"><link rel="prefetch" href="/assets/js/62.8c34fd00.js"><link rel="prefetch" href="/assets/js/63.be2c01c2.js"><link rel="prefetch" href="/assets/js/64.e87da56f.js"><link rel="prefetch" href="/assets/js/65.9b5d5e33.js"><link rel="prefetch" href="/assets/js/66.679b738b.js"><link rel="prefetch" href="/assets/js/67.e6d68708.js"><link rel="prefetch" href="/assets/js/68.989c0cc6.js"><link rel="prefetch" href="/assets/js/69.684885c9.js"><link rel="prefetch" href="/assets/js/7.4ee72216.js"><link rel="prefetch" href="/assets/js/70.9c91952b.js"><link rel="prefetch" href="/assets/js/71.1464e07d.js"><link rel="prefetch" href="/assets/js/72.1c2c6b93.js"><link rel="prefetch" href="/assets/js/73.8a613250.js"><link rel="prefetch" href="/assets/js/74.7c465239.js"><link rel="prefetch" href="/assets/js/75.ea4cb2c2.js"><link rel="prefetch" href="/assets/js/76.e3b110f2.js"><link rel="prefetch" href="/assets/js/77.fa7a31b0.js"><link rel="prefetch" href="/assets/js/78.39f83dea.js"><link rel="prefetch" href="/assets/js/79.25d6b2fa.js"><link rel="prefetch" href="/assets/js/8.b21ea89f.js"><link rel="prefetch" href="/assets/js/80.cb9c9016.js"><link rel="prefetch" href="/assets/js/81.81de8c83.js"><link rel="prefetch" href="/assets/js/82.c71ae9f7.js"><link rel="prefetch" href="/assets/js/83.39e50c48.js"><link rel="prefetch" href="/assets/js/84.6e920779.js"><link rel="prefetch" href="/assets/js/85.3fa17da8.js"><link rel="prefetch" href="/assets/js/86.1b3cb6a9.js"><link rel="prefetch" href="/assets/js/87.36451fdb.js"><link rel="prefetch" href="/assets/js/88.37712387.js"><link rel="prefetch" href="/assets/js/89.4cef831f.js"><link rel="prefetch" href="/assets/js/9.3b886d57.js"><link rel="prefetch" href="/assets/js/90.ad070d8a.js"><link rel="prefetch" href="/assets/js/91.5131f58b.js"><link rel="prefetch" href="/assets/js/92.a5080251.js"><link rel="prefetch" href="/assets/js/93.fd9a398b.js"><link rel="prefetch" href="/assets/js/94.54449211.js"><link rel="prefetch" href="/assets/js/95.c440971a.js"><link rel="prefetch" href="/assets/js/96.55366282.js"><link rel="prefetch" href="/assets/js/97.962ba1c4.js"><link rel="prefetch" href="/assets/js/98.6e5c4b28.js"><link rel="prefetch" href="/assets/js/99.0928e57f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f7eaaecd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-dad8a512><div data-v-dad8a512><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-dad8a512 data-v-dad8a512><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>Wallace's Blog</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>Wallace Xu</span>
            
          <span data-v-64685f0e>2019 - </span>
          2021
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Wallace's Blog" class="logo"> <span class="site-name">Wallace's Blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/个人随笔/" class="nav-link"><i class="iconfont undefined"></i>
  个人随笔
</a></li><li class="dropdown-item"><!----> <a href="/categories/知海拾贝/" class="nav-link"><i class="iconfont undefined"></i>
  知海拾贝
</a></li><li class="dropdown-item"><!----> <a href="/categories/LeetCode/" class="nav-link"><i class="iconfont undefined"></i>
  LeetCode
</a></li><li class="dropdown-item"><!----> <a href="/categories/剑指Offer/" class="nav-link"><i class="iconfont undefined"></i>
  剑指Offer
</a></li><li class="dropdown-item"><!----> <a href="/categories/自学技术/" class="nav-link"><i class="iconfont undefined"></i>
  自学技术
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系我
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/wallace4ever" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="mailto://pkxu@seu.edu.cn" class="nav-link external"><i class="iconfont reco-mail"></i>
  邮箱
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-ca798c94 data-v-dad8a512><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-ca798c94> <h3 class="name" data-v-ca798c94>
    Wallace Xu
  </h3> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>144</h3> <h6 data-v-ca798c94>文章</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>53</h3> <h6 data-v-ca798c94>标签</h6></div></div> <hr data-v-ca798c94></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/个人随笔/" class="nav-link"><i class="iconfont undefined"></i>
  个人随笔
</a></li><li class="dropdown-item"><!----> <a href="/categories/知海拾贝/" class="nav-link"><i class="iconfont undefined"></i>
  知海拾贝
</a></li><li class="dropdown-item"><!----> <a href="/categories/LeetCode/" class="nav-link"><i class="iconfont undefined"></i>
  LeetCode
</a></li><li class="dropdown-item"><!----> <a href="/categories/剑指Offer/" class="nav-link"><i class="iconfont undefined"></i>
  剑指Offer
</a></li><li class="dropdown-item"><!----> <a href="/categories/自学技术/" class="nav-link"><i class="iconfont undefined"></i>
  自学技术
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系我
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/wallace4ever" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="mailto://pkxu@seu.edu.cn" class="nav-link external"><i class="iconfont reco-mail"></i>
  邮箱
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>知海拾贝</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/views/知海拾贝/Go快速入门.html" class="active sidebar-link">Go语言快速入门</a></li><li><a href="/views/知海拾贝/JSON.html" class="sidebar-link">JSON简要说明</a></li><li><a href="/views/知海拾贝/Markdown学习.html" class="sidebar-link">Markdown基本语法学习</a></li><li><a href="/views/知海拾贝/Python快速上手.html" class="sidebar-link">Python快速上手</a></li><li><a href="/views/知海拾贝/使用Selenium进行web自动化测试.html" class="sidebar-link">使用Selenium进行web自动化测试</a></li><li><a href="/views/知海拾贝/使用VuePress与GitHub Pages快速搭建个人博客.html" class="sidebar-link">使用VuePress与GitHub Pages快速搭建个人博客</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>Go语言快速入门</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>Wallace Xu</span>
            
          <span data-v-64685f0e>2019 - </span>
          2021
        </a></span></div></div> <div data-v-dad8a512><main class="page"><div class="page-title" style="display:none;"><h1>Go语言快速入门</h1> <div data-v-3b7f5bdf><i class="iconfont reco-account" data-v-3b7f5bdf><span data-v-3b7f5bdf>Wallace Xu</span></i> <i class="iconfont reco-date" data-v-3b7f5bdf><span data-v-3b7f5bdf>2021-01-13</span></i> <!----> <i class="iconfont reco-tag tags" data-v-3b7f5bdf><span class="tag-item" data-v-3b7f5bdf>Golang</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><div class="custom-block tip"><p>Go（又称Golang）是Google开发的一种静态强类型、编译型、并发型，并具有垃圾回收功能的编程语言，被称为云计算时代的C语言，让我们来快速入门Go吧。</p></div> <p>Go语言最大的优势是在于其语言层面就支持并发，而不像Java那样需要导入JUC包，这样其开发效率和运行效率都有优势，并且使用Go编译的程序的运行速度可以媲美C或C++的速度，同时更加安全。</p> <p>Go语言的优势：</p> <ul><li>可以直接编译成机器码，运行时不依赖其他库（dll/so），部署就是放一个可执行文件到服务器就可以了。（不代表可以跨平台）</li> <li>Go是静态类型语言，在编译时就能检查出大多数问题，但是有动态语言的感觉。</li> <li>语言层面支持并发，可以充分利用多核。</li> <li>内置runtime，支持垃圾回收。</li> <li>简单易学，有C语言的基因。</li> <li>内置有丰富的标准库，特别是网络库非常强大。</li> <li>内置强大的工具，例如gofmt工具可以格式化代码，方便团队review。</li> <li>跨平台编译，如果代码中不包含cgo就可以做到在Windows系统下编译Linux应用</li> <li>内嵌C语言支持，可以直接包含C代码。</li></ul> <p>Go语言的使用场景：</p> <ul><li>服务器编程，例如处理日志、数据打包、虚拟机处理、文件系统等。</li> <li>分布式系统、数据库代理服务器等。</li> <li>网络编程，包括Web应用、API应用、下载应用。</li> <li>内存数据库。</li> <li>云平台。</li></ul> <p>一些基本的语法规则：</p> <ul><li>go语言以包作为管理单位，每个文件必须先声明包。</li> <li>运行程序的入口是main包的main函数，一个工程只能有一个main函数。</li> <li>语句结尾没有封号，除非要将多个语句写在一行。</li> <li>导入的包必须要使用，变量声明了也必须要使用。</li></ul> <h2 id="第一章-基本类型、流程控制"><a href="#第一章-基本类型、流程控制" class="header-anchor">#</a> 第一章 基本类型、流程控制</h2> <h3 id="_01-常量和变量"><a href="#_01-常量和变量" class="header-anchor">#</a> 01 常量和变量</h3> <p>Go语言中常量和变量的命名规范和很多语言类似，名字可以有字母、下划线、数字组成，不能以数字开头、不能是关键字、区分大小写。</p> <p><strong>声明变量的格式</strong>为<code>var 变量名1, 变量名2, ... 类型</code>，例如：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token builtin">int</span> <span class="token comment">//声明但没有初始化，默认初始化为0</span>
    <span class="token keyword">var</span> b <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment">//初始化</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a = &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
    a <span class="token operator">=</span> <span class="token number">5</span> <span class="token comment">//赋值</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a = &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>如果变量在声明时就进行初始化，那么可以省略类型，让编译器自动推导类型：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
    <span class="token comment">//var b = 20.0</span>
	b <span class="token operator">:=</span> <span class="token number">20.0</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;The type of b is %T\n&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token comment">//The type of b is float64</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Go还支持多重赋值：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
	a<span class="token punctuation">,</span> b <span class="token operator">:=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span> <span class="token comment">//多重赋值</span>
	a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token comment">//交换2个变量的值不需要temp变量，类似于python</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>匿名变量<code>_</code></strong>，类似于/dev/null黑洞设备，会丢弃被赋的值而不处理，搭配Go语言的返回值使用有优势。Go语言的函数可以返回多个值（谢天谢地不用像Java那样想要返回多个数据时得做一层封装了）：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e <span class="token builtin">int</span>
	c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//这三个变量会一次被赋值为1，2，3</span>
	<span class="token keyword">var</span> f <span class="token builtin">int</span> <span class="token comment">//如果我只想取用第二个返回值并赋值给f，那么就可以：</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> f<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//使用这些变量……</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>变量声明使用<code>var</code>关键字，常量声明则使用<code>const</code>关键字，常量赋值时自然也可以自动推导类型，但不能使用<code>:=</code>，只能用<code>const 常量名 = 常量值</code>。常量必须要在声明时就赋值。</p> <p><strong>多个变量或变量（可以是不同类型）的声明</strong>：在Java中，我们一次只能为同类型的多个变量或常量赋值，例如<code>int a = 1, b = 2; float c = 3.1f; double d = 4.6d;</code>，但在Go中我们可以同时声明不同类型的变量或常量：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> <span class="token punctuation">(</span>
		a <span class="token builtin">int</span> <span class="token comment">//在这里初始化也可以</span>
		b <span class="token builtin">int</span>
		c <span class="token builtin">float32</span>
		d <span class="token builtin">float64</span>
	<span class="token punctuation">)</span>
	a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3.1</span><span class="token punctuation">,</span> <span class="token number">4.6</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span>

	<span class="token keyword">const</span> <span class="token punctuation">(</span>
		i <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment">//这里让编译器来自动推导类型</span>
		j <span class="token operator">=</span> <span class="token number">12.1</span>
		k <span class="token comment">//这里比较特殊看起来没有赋值，实际值和上一行一样也是12.1</span>
	<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>iota常量枚举</strong>：在代码中每隔一行使用自动累加1，可以用于枚举：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token punctuation">(</span>
		a <span class="token operator">=</span> <span class="token boolean">iota</span> <span class="token comment">//0</span>
		b <span class="token operator">=</span> <span class="token boolean">iota</span> <span class="token comment">//1</span>
		c <span class="token operator">=</span> <span class="token boolean">iota</span> <span class="token comment">//2</span>
	<span class="token punctuation">)</span>

	<span class="token comment">//iota每次遇到const就会重置为0</span>
	<span class="token keyword">const</span> d <span class="token operator">=</span> <span class="token boolean">iota</span> <span class="token comment">//0</span>

	<span class="token comment">//可以只写一次</span>
	<span class="token keyword">const</span> <span class="token punctuation">(</span>
		e <span class="token operator">=</span> <span class="token boolean">iota</span> <span class="token comment">//0</span>
		f <span class="token comment">//1</span>
		g <span class="token comment">//2</span>
	<span class="token punctuation">)</span>

	<span class="token comment">//如果在同一行则值一样</span>
	<span class="token keyword">const</span> <span class="token punctuation">(</span>
		h <span class="token operator">=</span> <span class="token boolean">iota</span> <span class="token comment">//0</span>
		i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token boolean">iota</span><span class="token punctuation">,</span> <span class="token boolean">iota</span><span class="token punctuation">,</span> <span class="token boolean">iota</span> <span class="token comment">//都为1</span>
		l <span class="token operator">=</span> <span class="token boolean">iota</span> <span class="token comment">//2</span>
	<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="_02-基本数据类型"><a href="#_02-基本数据类型" class="header-anchor">#</a> 02 基本数据类型</h3> <p>Go语言内置以下基本数据类型：</p> <table><thead><tr><th style="text-align:left;">类型</th> <th style="text-align:left;">名称</th> <th style="text-align:center;">长度（字节数）</th> <th style="text-align:left;">零值</th> <th style="text-align:left;">说明</th></tr></thead> <tbody><tr><td style="text-align:left;">bool</td> <td style="text-align:left;">布尔类型</td> <td style="text-align:center;">1</td> <td style="text-align:left;">false</td> <td style="text-align:left;">不可以用数字代表true或false</td></tr> <tr><td style="text-align:left;">byte</td> <td style="text-align:left;">字节型</td> <td style="text-align:center;">1</td> <td style="text-align:left;">0</td> <td style="text-align:left;">uint8别名，可以用于存储ACSII码</td></tr> <tr><td style="text-align:left;">rune</td> <td style="text-align:left;">字符型</td> <td style="text-align:center;">4</td> <td style="text-align:left;">0</td> <td style="text-align:left;">专用于存储单个Unicode字符编码，等价于uint32</td></tr> <tr><td style="text-align:left;">int，uint</td> <td style="text-align:left;">整形</td> <td style="text-align:center;">4或8</td> <td style="text-align:left;">0</td> <td style="text-align:left;">32为或64位可变</td></tr> <tr><td style="text-align:left;">int8，uint8</td> <td style="text-align:left;">整形</td> <td style="text-align:center;">1</td> <td style="text-align:left;">0</td> <td style="text-align:left;">8位整形或无符号整形，占1字节，-128~127或0~255</td></tr> <tr><td style="text-align:left;">int16，uint16</td> <td style="text-align:left;">整形</td> <td style="text-align:center;">2</td> <td style="text-align:left;">0</td> <td style="text-align:left;">16位整形或无符号整形，-32768~32767或0~65535</td></tr> <tr><td style="text-align:left;">int32，uint32</td> <td style="text-align:left;">整形</td> <td style="text-align:center;">4</td> <td style="text-align:left;">0</td> <td style="text-align:left;">同理，-2147483648~2147483648或0~4294967295</td></tr> <tr><td style="text-align:left;">int64，uint64</td> <td style="text-align:left;">整形</td> <td style="text-align:center;">8</td> <td style="text-align:left;">0</td> <td style="text-align:left;">同理</td></tr> <tr><td style="text-align:left;">float32</td> <td style="text-align:left;">浮点型</td> <td style="text-align:center;">4</td> <td style="text-align:left;">0.0</td> <td style="text-align:left;">小数位精确到7位</td></tr> <tr><td style="text-align:left;">float64</td> <td style="text-align:left;">浮点型</td> <td style="text-align:center;">8</td> <td style="text-align:left;">0.0</td> <td style="text-align:left;">小数位精确到15位</td></tr> <tr><td style="text-align:left;">complex64</td> <td style="text-align:left;">复数类型</td> <td style="text-align:center;">8</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">complex128</td> <td style="text-align:left;">复数类型</td> <td style="text-align:center;">16</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">uintptr</td> <td style="text-align:left;">整形</td> <td style="text-align:center;">4或8</td> <td style="text-align:left;"></td> <td style="text-align:left;">足以存储指针的uint32或uint64整数</td></tr> <tr><td style="text-align:left;">string</td> <td style="text-align:left;">字符串</td> <td style="text-align:center;"></td> <td style="text-align:left;">空串&quot;&quot;</td> <td style="text-align:left;">utf-8字符串</td></tr></tbody></table> <p>一些示例：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//1. byte/rune类型的数据和整数的运算</span>
	<span class="token keyword">var</span> ch1 <span class="token builtin">byte</span>
	ch1 <span class="token operator">=</span> <span class="token number">97</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%c, %d\n&quot;</span><span class="token punctuation">,</span> ch<span class="token punctuation">,</span> ch<span class="token punctuation">)</span> <span class="token comment">//使用格式控制，打印结果是a和97</span>
	ch1 <span class="token operator">=</span> <span class="token string">'A'</span> <span class="token comment">//这里只能是ASCII字符，如果是Unicode字符编译时汇报溢出byte类型</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;大写转小写结果：%c\n&quot;</span><span class="token punctuation">,</span> ch <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;d的大写形式：%c\n&quot;</span><span class="token punctuation">,</span> <span class="token string">'d'</span> <span class="token operator">-</span> <span class="token number">32</span><span class="token punctuation">)</span>

	<span class="token keyword">var</span> ch2 <span class="token builtin">rune</span> <span class="token operator">=</span> <span class="token string">'中'</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;中的下一个编码字符是：%c\n&quot;</span><span class="token punctuation">,</span> ch2<span class="token punctuation">)</span>

	<span class="token comment">//2. string类型，内建函数len()可以测字符串长度，字符串末尾隐藏了一个结束符'\0'</span>
	str <span class="token operator">:=</span> <span class="token string">&quot;This is content.&quot;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;str的字符长度是：&quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;str[0]:&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;str[1]:&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">//这样打印出来是ASCII码整数</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;str[0]: %c str[1]: %c\n&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">//使用格式控制来打印出单个字符</span>

	<span class="token comment">//3. 复数类型，内建函数real()和imag()可以用于取出实部和虚部</span>
	<span class="token keyword">var</span> c1 <span class="token builtin">complex128</span> <span class="token operator">=</span> <span class="token number">2.1</span> <span class="token operator">+</span> <span class="token number">3.14i</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;实部：&quot;</span><span class="token punctuation">,</span> <span class="token function">real</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;虚部：&quot;</span><span class="token punctuation">,</span> <span class="token function">imag</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_03-fmt包的格式化输入输出"><a href="#_03-fmt包的格式化输入输出" class="header-anchor">#</a> 03 fmt包的格式化输入输出</h3> <p>Printf()函数的格式化字符有很多，一部分和c语言相通，常用的有：</p> <ul><li>%c，字符型，可以把合法的整数按照Unicode码表转换成字符输出</li> <li>%d，十进制整形</li> <li>%o，八进制整形</li> <li>%f，浮点数</li> <li>%e/%E，科学计数法表示的浮点数</li> <li>%x/%X，十六进制整数</li> <li>%s，字符串，输出字符串的字符直到空字符'\0'为止</li> <li>%T，Go语言中的数据类型</li> <li>%v，使用默认格式输出</li></ul> <p>读取用户输入：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token builtin">int</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;请输入一个整数：&quot;</span><span class="token punctuation">)</span>
	<span class="token comment">//这里会阻塞，等待用户输入</span>
	fmt<span class="token punctuation">.</span><span class="token function">Scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span> <span class="token comment">//类似于c语言，读取格式化输入数据后存放到a的地址处</span>
	<span class="token comment">//也可以不指定输入格式</span>
	fmt<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_04-类型转换和别名"><a href="#_04-类型转换和别名" class="header-anchor">#</a> 04 类型转换和别名</h3> <p>Go语言不允许隐式的转换，必须显式声明，另外两种类型必须兼容（例如byte/rune和整形兼容，bool类型和整形不兼容不能互相转换），例如：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> ch <span class="token builtin">byte</span> <span class="token operator">=</span> <span class="token number">97</span>
<span class="token keyword">var</span> a <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token function">int</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>类型别名：我们可以使用<code>type</code>关键字给已有的类型起别名，例如要给int64类型起别名为bigint：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> long <span class="token builtin">int64</span>
	<span class="token keyword">var</span> b long
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Type of b : %T&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token comment">//Type of b : main.long</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_05-运算符"><a href="#_05-运算符" class="header-anchor">#</a> 05 运算符</h3> <p>Go语言的算术运算符和大多数语言相同：<code>+-*/%</code>，但注意Go语言中自增自减运算符<code>++</code>和<code>--</code>只能后置不能前置。</p> <p>Go语言的关系运算符的写法也和大多数语言相同：大于<code>&gt;</code>、小于<code>&lt;</code>、等于<code>==</code>、大于等于<code>&gt;=</code>、小于等于<code>&lt;=</code>，不等于<code>!=</code>。</p> <p>Go语言的逻辑运算符也和大多数语言相同：与<code>&amp;&amp;</code>、或<code>||</code>以及非<code>!</code>。</p> <p>Go语言的位运算符包括：按位与<code>&amp;</code>、按位或<code>|</code>、按位异或<code>^</code>、左移<code>&lt;&lt;</code>以及右移<code>&gt;&gt;</code>。</p> <p>Go语言和C语言类似还有取地址运算符<code>&amp;</code>和取值运算符<code>*</code>，两者分别对变量和指针变量有效，例如<code>&amp;a</code>表示取变量a的地址、<code>*a</code>表示取指针变量a所指向的内存中存放的值。</p> <h3 id="_06-流程控制"><a href="#_06-流程控制" class="header-anchor">#</a> 06 流程控制</h3> <p>Go语言和大多数语言一样支持顺序结构、选择结构和循环结构。</p> <p>选择结构：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// if 选择</span>
<span class="token keyword">func</span> <span class="token function">testIf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	s <span class="token operator">:=</span> <span class="token number">92</span>
	<span class="token keyword">if</span> s <span class="token operator">&gt;=</span> <span class="token number">80</span> <span class="token punctuation">{</span> <span class="token comment">//Go的判断条件不需要加括号</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;成绩优秀&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//if支持写入一个初始化语句，初始化语句和判断条件用分号分隔</span>
	<span class="token keyword">if</span> t <span class="token operator">:=</span> <span class="token number">75</span><span class="token punctuation">;</span> t <span class="token operator">&gt;=</span> <span class="token number">80</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;成绩优秀&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> t <span class="token operator">&gt;=</span> <span class="token number">60</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;成绩不佳&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span><span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;不及格&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// switch 选择</span>
<span class="token keyword">func</span> <span class="token function">testSwitch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	sex <span class="token operator">:=</span> <span class="token string">'男'</span>
	<span class="token keyword">switch</span> sex <span class="token punctuation">{</span> <span class="token comment">//同样地，sex也不用加括号</span>
		<span class="token keyword">case</span> <span class="token string">'男'</span><span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;左转&quot;</span><span class="token punctuation">)</span>
			<span class="token keyword">break</span> <span class="token comment">//Go保留了break关键字，但switch语句中每个case结束默认break所以不用写</span>
		<span class="token keyword">case</span> <span class="token string">'女'</span><span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;右转&quot;</span><span class="token punctuation">)</span>
			<span class="token keyword">fallthrough</span> <span class="token comment">//如果使用了该关键字并能被执行到这里，下面的所有case都会无条件执行</span>
		<span class="token keyword">default</span> <span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;起飞&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//类似地，可以把一条初始化语句放到switch中</span>
	<span class="token keyword">switch</span> age <span class="token operator">:=</span> <span class="token number">24</span><span class="token punctuation">;</span> age <span class="token punctuation">{</span>
		<span class="token keyword">case</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">:</span>
			<span class="token comment">//some actions</span>
		<span class="token comment">//...</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//switch也可以没有目标变量，这时要在case中放条件</span>
	score <span class="token operator">:=</span> <span class="token number">81</span>
	<span class="token keyword">switch</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> score <span class="token operator">&gt;=</span> <span class="token number">80</span><span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;成绩优秀&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">case</span> score <span class="token operator">&gt;=</span><span class="token number">60</span><span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;成绩良好&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">default</span><span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;不及格&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p>循环结构：Go语言中没有while或者do...while关键字，只有for循环和range迭代器：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//一般的for循环</span>
<span class="token keyword">func</span> <span class="token function">testFor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	sum <span class="token operator">:=</span> <span class="token number">0</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">{</span> <span class="token comment">//同样不需要括号</span>
		sum <span class="token operator">+=</span> i
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;sum = &quot;</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span>

	str <span class="token operator">:=</span> <span class="token string">&quot;abc&quot;</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">len</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;str[%d] is %c\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//range默认返回两个值：元素的位置和元素本身</span>
<span class="token keyword">func</span> <span class="token function">testRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	str <span class="token operator">:=</span> <span class="token string">&quot;abc&quot;</span>
	<span class="token keyword">for</span> i<span class="token punctuation">,</span> data <span class="token operator">:=</span> <span class="token keyword">range</span> str <span class="token punctuation">{</span> <span class="token comment">//如果不需要第二个返回值可以写为i := 或者i, _ :=</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;str[%d] is %c\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>在Go中，<code>break</code>关键字可以用于for、switch和select，而continue只能用于for循环。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">testBreak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	i <span class="token operator">:=</span> <span class="token number">0</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span> <span class="token comment">//可以按照需要省略初始条件、终止条件和动作，如果都省略那么两个封号也可以省略（死循环）</span>
		i<span class="token operator">++</span>
		<span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">5</span> <span class="token punctuation">{</span>
			<span class="token keyword">break</span> 
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;i = &quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Go语言保留了<code>goto</code>关键字，但是尽量不要使用，频繁使用goto跳转会让代码逻辑看起来很混乱。goto可以用在任何地方，但是不能跨函数跳转。用户定义的标签（label）定义了就一定要使用否则编译不通过。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">testGoto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Step 1&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">goto</span> MyLabel
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Step 2&quot;</span><span class="token punctuation">)</span>
MyLabel<span class="token punctuation">:</span> <span class="token comment">//</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Step 3&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="第二章-函数、工程管理"><a href="#第二章-函数、工程管理" class="header-anchor">#</a> 第二章 函数、工程管理</h2> <p>Go语言的函数名称首字母小写则为private、大写则为public，定义格式如下：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">FuncName</span><span class="token punctuation">(</span><span class="token comment">/*参数列表*/</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>o1<span class="token punctuation">,</span> o2 type1<span class="token punctuation">,</span> o3 type2 <span class="token comment">/*返回类型*/</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//函数体</span>

	<span class="token keyword">return</span> v1<span class="token punctuation">,</span> v2<span class="token punctuation">,</span> v3 <span class="token comment">//返回多个值</span>
<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_01-自定义函数"><a href="#_01-自定义函数" class="header-anchor">#</a> 01 自定义函数</h3> <p>定义无参数、无返回值的函数：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">MyFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;This is a test function.&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>定义有普通参数、无返回值的函数：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//这里的abc称为形参</span>
<span class="token keyword">func</span> <span class="token function">MyFunc</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">,</span> c <span class="token builtin">string</span> <span class="token comment">/*这里不需要var关键字*/</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;a = %d, b = %d, c is %s\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//传递的是实参</span>
	<span class="token function">MyFunc</span><span class="token punctuation">(</span><span class="token number">233</span><span class="token punctuation">,</span> <span class="token number">2333</span><span class="token punctuation">,</span> <span class="token string">&quot;cool&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>定义有不定参数（指参数的个数不确定）、无返回值的函数：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//不定参数（类似于Java中本质上是数组的可变参数），其本质是切片</span>
<span class="token comment">//和Java一样，不定参数可以和普通参数一起使用，但只能放在形参列表的最后</span>
<span class="token keyword">func</span> <span class="token function">MyFunc</span><span class="token punctuation">(</span>args <span class="token operator">...</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;len(args) = &quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">len</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;args[%d] = %d\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">for</span> i<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> args <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;args[%d] = %d\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>在不同多个函数之间传递不定参数：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">MiddleFunc</span><span class="token punctuation">(</span>args <span class="token operator">...</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//调用上面的函数，把全部元素传递过去</span>
	<span class="token function">MyFunc</span><span class="token punctuation">(</span>args<span class="token operator">...</span><span class="token punctuation">)</span>
	<span class="token comment">//假设不定参数有4个，我只想把后2个（第2、3个）参数传递出去</span>
	<span class="token function">MyFunc</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">...</span><span class="token punctuation">)</span> <span class="token comment">//从args[2]开始到结束，左闭右开，类似于Python的切片写法</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>定义无参数、有一个返回值的函数：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//只有1个返回值</span>
<span class="token keyword">func</span> <span class="token function">MyFunc1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span> <span class="token comment">//只有1个返回值可以省略第二个括号</span>
	<span class="token comment">//some codes</span>
	<span class="token keyword">return</span> <span class="token number">666</span>
<span class="token punctuation">}</span>

<span class="token comment">//给返回值起一个变量名，Go推荐写法</span>
<span class="token keyword">func</span> <span class="token function">MyFunc2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>result <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	result <span class="token operator">=</span> <span class="token number">777</span>
	<span class="token keyword">return</span> <span class="token comment">//这里直接return，因为知道要返回result的值，当然直接写return 777也可以</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>定义无参数、有多个返回值的函数：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">MyFunc3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span>
<span class="token punctuation">}</span>

<span class="token comment">//推荐写法，为返回值起名</span>
<span class="token keyword">func</span> <span class="token function">MyFunc3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_02-递归函数"><a href="#_02-递归函数" class="header-anchor">#</a> 02 递归函数</h3> <p>递归函数没什么特别的，注意递归终止条件即可。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//示例1：打印1到正整数n</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">test</span><span class="token punctuation">(</span>a <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> a <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token function">test</span><span class="token punctuation">(</span>a <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a = &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//示例2：求1+2+...+n</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;result = &quot;</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">add</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> n <span class="token operator">&lt;=</span> <span class="token number">0</span> 
		<span class="token keyword">return</span> <span class="token number">0</span>
	<span class="token keyword">return</span> n <span class="token operator">+</span> <span class="token function">add</span><span class="token punctuation">(</span>n <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_03-函数类型"><a href="#_03-函数类型" class="header-anchor">#</a> 03 函数类型</h3> <p>在Go语言中，函数也是一种数据类型，同样可以使用<code>type</code>关键字来定义。它的类型就是拥有相同参数、相同返回值的一种类型。使用自定义的函数类型我们可以实现多态与函数回调。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">//例如我可以定义一种整数二则运算的类型</span>
<span class="token keyword">type</span> FuncType <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> <span class="token punctuation">(</span>
		operand1<span class="token punctuation">,</span> operand2 <span class="token builtin">int</span>
		f FuncType
	<span class="token punctuation">)</span>

	operand1<span class="token punctuation">,</span> operand2 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span>
	f <span class="token operator">=</span> MyMod <span class="token comment">//f可以是任何满足FuncType定义的函数，这就是一种多态的体现</span>
	
	<span class="token comment">//当然直接写result := f(operand1, operand2)也可以，那就体现不出回调了</span>
	result <span class="token operator">:=</span> <span class="token function">InvokeCalculation</span><span class="token punctuation">(</span>operand1<span class="token punctuation">,</span> operand2<span class="token punctuation">,</span> f<span class="token punctuation">)</span> 
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;result =&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//调用时只关心f是一个FuncType类型的函数，可以处理两个整形操作数并返回一个整形值</span>
<span class="token keyword">func</span> <span class="token function">InvokeCalculation</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span> o2 <span class="token builtin">int</span><span class="token punctuation">,</span> f FuncType<span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Invoking function f...&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span> o2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">MyAdd</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span> o2 <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> o1 <span class="token operator">+</span> o2
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">MyMod</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span> o2 <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> o1 <span class="token operator">%</span> o2
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>通过使用函数类型，我们可以将函数作为另一个函数的参数，从而实现函数的回调（正如上面的InvokeCalculation函数）。使用回调极大地提升了函数的可扩展性。</p> <div class="custom-block tip"><p>作为对比，Java中实现方法的回调需要用到的参数是类或接口的实例，通过instance.method(operand)来实现回调。</p></div> <h3 id="_04-匿名函数与闭包"><a href="#_04-匿名函数与闭包" class="header-anchor">#</a> 04 匿名函数与闭包</h3> <p>所谓闭包就是一个函数“捕获”了和它在同一作用域的其他变量常量。这就意味着无论在什么地方当闭包被调用的时候，闭包都能使用这些变量常量。它不关心这些量是否已经超出了作用域，只要闭包还在使用他们，他们就还会存在。</p> <p>在Go中，闭包是通过匿名函数来实现的。（正如同Java中内部类可以访问外部类的成员变量或外部方法的局部变量，匿名内部类可以访问外部方法用final修饰的局部变量）</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//其中的匿名函数和外部函数形成了闭包</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token number">10</span>
	b <span class="token operator">:=</span> <span class="token number">20</span>
	str <span class="token operator">:=</span> <span class="token string">&quot;mike&quot;</span>

	<span class="token comment">//匿名函数，没有名字，只是定义还没有调用</span>
	f1 <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//这里通过自动推导给匿名函数命了名</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a = &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;str = &quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//调用</span>

	<span class="token comment">//写法2：定义并同时调用</span>
	<span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;a = %d, str = %s\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//这个括号表示给该函数传参，不过我们定义的函数没有参数所以括号内没有内容</span>

	<span class="token comment">//例3：定义有参数有返回值的匿名函数并同时调用</span>
	x<span class="token punctuation">,</span> y <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>max<span class="token punctuation">,</span> min <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> i <span class="token operator">&gt;</span> j <span class="token punctuation">{</span>
			max <span class="token operator">=</span> i
			min <span class="token operator">=</span> j
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			max <span class="token operator">=</span> j
			min <span class="token operator">=</span> i
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>Go语言中闭包是以<strong>引用</strong>的方式捕获外部变量，在匿名函数中修改外部变量后，外部函数中看到的变量是修改后的。（不像Java中final关键字从设计上让匿名内部类看到的只是外部变量的<strong>拷贝</strong>）</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//返回值为一个匿名函数，该函数没有参数，返回值为int类型</span>
<span class="token keyword">func</span> <span class="token function">squares</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> x <span class="token builtin">int</span> <span class="token comment">//没有初始化，值为0</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
		x<span class="token operator">++</span>
		<span class="token keyword">return</span> x <span class="token operator">*</span> x
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//用变量f接收这个匿名函数/闭包函数</span>
	f <span class="token operator">:=</span> <span class="token function">squares</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//1，首次调用后x=1，并且return后依然存在（普通函数调用后变量就被回收了）</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//4</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//9</span>

	f <span class="token operator">=</span> <span class="token function">squares</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//再次生成x并返回新的匿名函数，这时重复执行打印会得到1，4，9，16，...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>上面的例子说明，闭包使用的外部变量的生命周期不由它的作用域决定。对squares()的一次调用会生成一个局部变量x并返回一个匿名函数，之后变量x仍然隐式存在于f中。</p> <h3 id="_05-延迟调用defer"><a href="#_05-延迟调用defer" class="header-anchor">#</a> 05 延迟调用defer</h3> <p>Go中的defer类似于C++中的析构函数，用于在调用结束前做一些收尾清理的工作，例如关闭文件、网络连接等。defer语句只能放在函数的内部，但不要求放在源代码的结尾。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;closing...&quot;</span><span class="token punctuation">)</span> <span class="token comment">//这一句会在最后执行</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;working...&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果有多个defer语句，在源代码中先写的后被执行（LIFO）。如果某行普通语句在运行时发生错误，在其之前的defer语句依旧会被执行（之后的defer语句不会）。如果某个延迟调用语句在运行时发生错误，其余的调用依旧会被执行。</p> <p>延迟执行类似于在从上往下执行代码时，遇到defer就把该语句放入某个栈中，当程序运行结束或遇到异常退出时，会把已经在栈中的语句取出执行（所以错误之后的defer语句不会执行）。</p> <p>defer和匿名函数结合使用：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token number">10</span>
	b <span class="token operator">:=</span> <span class="token number">20</span>
	
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//由于是延迟执行，所以调用匿名函数时捕获到的a、b已经是修改后的值</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;a = %d, b = %d\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//如果这里把匿名函数的形参写成(a, b int)那么下一行打印的就是形参而非外部的a和b</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;a = %d, b = %d\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token comment">//外部的a和b</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;参数x = %d, y = %d\n&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token comment">//传进来的参数的值</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token comment">//注意在延迟执行时，已经传递的参数是当时未修改的a和b的值</span>

	a <span class="token operator">=</span> <span class="token number">111</span>
	b <span class="token operator">=</span> <span class="token number">222</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;a = %d, b = %d\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_06-获取命令行参数"><a href="#_06-获取命令行参数" class="header-anchor">#</a> 06 获取命令行参数</h3> <p>要获取用户从命令行传递的参数，需要导入<code>os</code>这个包：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;os&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	list <span class="token operator">:=</span> os<span class="token punctuation">.</span>Args
	n <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;参数个数：&quot;</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>我们使用go build命令编译得到可执行文件如program，那么在命令行下执行<code>program arg1 arg2</code>，程序名本身也是一个参数，所以一共有三个参数。</p> <p>os.Args本质是<code>var Args []string</code>，所以可以通过for迭代遍历（list[i]/range）。</p> <h3 id="_07-作用域"><a href="#_07-作用域" class="header-anchor">#</a> 07 作用域</h3> <p>和多数语言一样，Go语言中在<code>{}</code>内的变量是局部变量，定义在函数外部的变量是全局变量（需要使用var定义，不可以自动推导）。变量重名时优先使用局部变量。</p> <h3 id="_08-工程管理"><a href="#_08-工程管理" class="header-anchor">#</a> 08 工程管理</h3> <p><strong>一</strong>，Go代码必须要放在工作区中。工作区其实是一个对应特定工程的目录，包含三个子目录:</p> <ul><li>src，必须，用于以代码包的形式组织并保存Go源码文件。</li> <li>pkg，非必须，用于存放经由go install命令构建安装后的代码包。</li> <li>bin，非必须，用于存放经由go install命令安装后生成的可执行文件。</li></ul> <p>需要注意的是，环境变量GOPATH中如果只有一个工作区的路径时，go install命令才会安装到该目录的bin目录下，否则需要设置GOBIN环境变量。</p> <p>为了能构建某个工程，需要先把工程的根目录加到环境变量GOPATH中，否则代码之间无法通过绝对代码包路径完成调用。注意设置环境变量时Linux下的分隔符是冒号，Windows下的分隔符是分号。</p> <p><strong>二</strong>，需要了解一些关于包的使用方式。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//导入时使用.可以在后面使用包中的函数或全局变量时，无需指定包名。类似于Java的静态导入</span>
<span class="token comment">//但要少使用这种方法，因为可能会和自己定义的函数、变量重名</span>
<span class="token keyword">import</span> <span class="token punctuation">.</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">.</span> <span class="token string">&quot;os&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span>
	<span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;os.Args = &quot;</span><span class="token punctuation">,</span> Args<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//导入包时还可以给包起别名</span>
<span class="token keyword">import</span> io <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">//导入时可以忽略某个包，编译可以通过。其本质是仅调用该包里的init函数</span>
<span class="token keyword">import</span> <span class="token boolean">_</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	io<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>同一个目录下的.go文件中的包名必须一样。同一个目录下，调用别的文件中的函数无需包名引用。</p> <p>不同的目录，包名不一样。调用不同包的函数，首先要导入该包，并且该函数首字母要大写。</p> <p>所有用Go编译的单个可执行程序都必须有且仅有一个叫main的包，main包中必须有一个main函数用作程序入口。另外Go还有一个保留的函数init()，这两个函数在定义时都不能有任何参数和返回值。虽然一个package中可以有多个init函数，但从可读性、可维护性的角度出发建议每个package中只写一个init函数。Go程序运行时会自动调用main和init函数（后者在前者之前执行，导入包的init函数在main包的init函数之前执行）</p> <h2 id="第三章-复合类型"><a href="#第三章-复合类型" class="header-anchor">#</a> 第三章 复合类型</h2> <p>符合类型的长度就不像基本数据类型那样是固定的，而是根据内容而变化的。</p> <h3 id="_01-指针"><a href="#_01-指针" class="header-anchor">#</a> 01 指针</h3> <p>指针代表某个内存地址的值，往往是内存中一个变量的起始位置。Go语言对于指针的支持介于Java和C/C++之间，没有像Java一样取消了对指针的直接操作能力，也避免了C/C++中由于对指针的滥用而造成的安全性和可靠性问题。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">10</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;a = %d\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">//变量a的内容</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;&amp;a = %v\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span> <span class="token comment">//变量a在内存中的首地址</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>为了保存某个变量的地址，需要指针类型。例如要保存<code>int</code>类型变量的地址需要<code>*int</code>、要保存<code>*int</code>类型变量的地址需要<code>**int</code>。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">10</span>
	<span class="token keyword">var</span> p <span class="token operator">*</span><span class="token builtin">int</span> <span class="token comment">//p是指针，此时还没有指向a，默认值为nil</span>
	p <span class="token operator">=</span> <span class="token operator">&amp;</span>a
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;p = %v\n&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>

	<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">666</span> <span class="token comment">//*p操作的不是指针类型变量p的内存，而是p所指向的内存（即a）</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>当指针类型为nil时即没有合法指向时，不要通过<code>*p</code>的方式进行操作，否则会出现<code>nil pointer dereference</code>，即空指针间接引用异常。</p> <p>除了<code>*p = &amp;a</code>这种指向方式，还可以使用<code>new(T)</code>函数。该函数将创建一个<code>T</code>类型的匿名变量，准确来说是为该类型分配一块新的内存空间，并返回该内存空间的地址，我们可以用指针类型<code>*T</code>来接收这个地址。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> p1 <span class="token operator">*</span><span class="token builtin">int</span>
	p1 <span class="token operator">=</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token comment">//p1指向匿名的int类型变量</span>
	
	p2 <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>
	<span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token number">111</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>new()函数类似于C语言中的动态申请空间，不过Go语言有内存回收机制，所以开发者只需要申请不需要手动回收内存。</p> <p>另外，由于Go语言在进行函数调用时使用的是值传递，那么假如我要编写一个函数交换两个整形数的值：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a<span class="token punctuation">,</span> b <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span>
	<span class="token function">Swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;In main: %d, %d\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
	<span class="token function">TrueSwap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span> <span class="token comment">//取地址传给指针类型的形参</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;In main: %d, %d\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//该方式仅仅在函数作用域内交换了两个形参的值，但是外部调用的函数中变量a、b的值没有改变</span>
<span class="token keyword">func</span> <span class="token function">Swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;In Swap: %d, %d\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//我们需要通过指针来操作原变量内存地址处的内容</span>
<span class="token keyword">func</span> <span class="token function">TrueSwap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token operator">*</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token operator">*</span>b <span class="token operator">=</span> <span class="token operator">*</span>b<span class="token punctuation">,</span> <span class="token operator">*</span>a
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;In Swap: %d, %d\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token operator">*</span>b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_02-数组"><a href="#_02-数组" class="header-anchor">#</a> 02 数组</h3> <p>数组的概念大家都不陌生，Go中定义数组的示例为：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> array <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token builtin">int</span>

	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">len</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment">//操作数组时的下标可以是变量</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;array[%d] = %d\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>数组的长度必须是常量（不可以是变量），且是类型的组成部分，<code>[2]int</code>和<code>[3]int</code>是不同的类型。在Java中我们可以这样写：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>array<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
	n <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>但Go中就不可以，n必须是一个常量：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> n <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">10</span>
	<span class="token keyword">var</span> arr <span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token builtin">int</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>我们可以在声明时就对数组进行初始化（对比Java中可以<code>int[] arr = new int[]{1, 2, 3};</code>）：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> array <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span> <span class="token comment">//和变量一样如果直接赋值则前面的类型可以省略</span>
	<span class="token comment">//array := [3]int {1, 2, 3}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;array = &quot;</span><span class="token punctuation">,</span> array<span class="token punctuation">)</span>

	<span class="token comment">//Go中可以对数组进行部分初始化，未初始化的元素为默认值</span>
	array2 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span> <span class="token comment">//第0~2个元素被初始化，第3~4个元素默认为0</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;array2 = &quot;</span><span class="token punctuation">,</span> array2<span class="token punctuation">)</span>

	<span class="token comment">//Go中还可以指定某个位置的元素初始化</span>
	array3 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span> <span class="token comment">//只初始化了下标为2和4的元素</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;array3 = &quot;</span><span class="token punctuation">,</span> array3<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>多维数组示例：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> arr <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token builtin">int</span>
	count <span class="token operator">:=</span> <span class="token number">0</span>

	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">{</span>
			arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> count
			count<span class="token operator">++</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>

	arr2 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment">//初始化</span>
	arr3 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment">//部分初始化</span>
	arr4 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment">//部分初始化</span>
	arr5 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment">//指定初始化第1行</span>
	arr6 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment">//指定初始化第1行中的第1、3列</span>
	<span class="token comment">//使用这些数组...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>Go语言中的数组原生支持用==或!=比较，要求被比较的数组类型一样。（对比Java中只能用Arrays.equals(arr1,arr2)方法来比较）另外，数组也可以通过等号直接用于给同类型的数组赋值。（对比Java中只能用Arrays.copyOf或者System.arrayCopy方法，如果使用等号则仅仅是创建了原数组的一个引用）：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
	b <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a == b? &quot;</span><span class="token punctuation">,</span> a <span class="token operator">==</span> b<span class="token punctuation">)</span>

	<span class="token comment">//c := a</span>
	<span class="token keyword">var</span> c <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span>
	c <span class="token operator">=</span> a
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>数组如果用作函数的参数，那么是值传递，形参是实参的一份拷贝。如果想要修改同一个数组那么就需要传递指针。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">modify</span><span class="token punctuation">(</span>arrPointer <span class="token operator">*</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">(</span><span class="token operator">*</span>arrPointer<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">666</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Original array modified.&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>拓展：随机数的使用：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;math/rand&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">DoRand</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
	<span class="token comment">//设置种子，种子固定后每次运行产生的随机数序列也是固定的（伪随机）</span>
	rand<span class="token punctuation">.</span><span class="token function">Seed</span><span class="token punctuation">(</span><span class="token number">666</span><span class="token punctuation">)</span>
	<span class="token comment">//可以用当前时间作为种子，那么每次运行结果是不一样的</span>
	<span class="token comment">//rand.Seed(time.Now().UnixNano())</span>

	<span class="token comment">//产生随机数</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;rand = &quot;</span><span class="token punctuation">,</span> rand<span class="token punctuation">.</span><span class="token function">Int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//产生非负的随机整数，范围较大</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;rand = &quot;</span><span class="token punctuation">,</span> rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//产生限定范围的整数</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_03-slice"><a href="#_03-slice" class="header-anchor">#</a> 03 slice</h3> <p>数组的长度再定义后无法修改，并且数组传递是值传递，每次传递都将产生一份副本。Go语言提供了切片来弥补数组的不足。</p> <p>切片并不是数组或数组指针，它通过内部指针和相关属性引用数组片段，以实现变长方案。定义切片可以由数组得来：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	array <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">}</span>
	<span class="token comment">//array[low:high:max]</span>
	slice <span class="token operator">:=</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token comment">//起始位置为0，终止位置为3（左闭右开），最大终止位置为5（所以容量为5-0）</span>
	<span class="token comment">//如果不指定容量就和长度一样</span>
	slice2 <span class="token operator">:=</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">//取数组第0、1、2位置的元素</span>
	slice3 <span class="token operator">:=</span> array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment">//取数组全部元素</span>
	slice4 <span class="token operator">:=</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">//取数组第0个元素</span>
	slice5 <span class="token operator">:=</span> array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">//同array[0:3]</span>
	slice6 <span class="token operator">:=</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment">//从第2位到末尾</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>上面的定义中切片长度与容量是固定的，也可以直接定义不定长的切片：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//中括号内不指定数字或写为`...`就表示这是一个变长的切片</span>
	slice <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token comment">//给切片追加一个成员</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>append()函数会智能地控制底层数组容量的增长，一旦超过底层数组容量，通常以2倍容量重新分配底层数组。</p> <p>还可以通过make()函数制作切片：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	s2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">//参数分别为切片类型，长度，容量（也可以只给出类型和数字，不分别指定长度和容量）</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>切片元素可以像数组那样进行修改，对切片进行修改后，底层的数组也会被修改。</p> <p>使用copy(destSlice, srcSlice)函数可以实现把srcSlice的元素拷贝至destSlice中对应的位置上（覆盖原有的元素）。</p> <div class="custom-block warning"><p>注意，切片用作参数时是引用传递，修改形参会对实参产生影响。</p></div> <h3 id="_04-map"><a href="#_04-map" class="header-anchor">#</a> 04 map</h3> <p>Go语言中的map和很多语言一样，是一种键值对的数据结构，键唯一，map可以用基本数据类型作为键值，但不能使用数组和切片。对map只能使用len()函数，不能使用cap()函数。</p> <p>map的创建和初始化方式：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> m1 <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token comment">//空的，len(m1)=0</span>
	<span class="token comment">//也可以通过make()函数来创建</span>
	m2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span>
	m3 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">//指定初始长度</span>

	<span class="token comment">//操作map中的元素时可以使用map[key] = value的形式</span>
	m3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;mike&quot;</span> <span class="token comment">//已经存在该key则修改，不存在则追加</span>
	m3<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;wallace&quot;</span>

	<span class="token comment">//在定义map时就可以对其进行初始化</span>
	m4 <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">:</span><span class="token string">&quot;wallace&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>map是无序的，当map中的元素超过初始长度时会自动扩容。</p> <p>遍历map时可以使用range迭代遍历，但注意遍历的结果是无序的：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	m <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token string">&quot;wallace&quot;</span><span class="token punctuation">}</span>
	<span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> m <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;key is:&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token string">&quot;value is:&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>要判断一个key是否存在，可以通过下面的方式：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	m <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token string">&quot;wallace&quot;</span><span class="token punctuation">}</span>
	value<span class="token punctuation">,</span> ok <span class="token operator">:=</span> m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
	<span class="token keyword">if</span> ok <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;m[3]=&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;key does not exist!&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>要删除某一个key值，可以使用delete(map, key)函数来实现。map在传参时是引用传递。</p> <h3 id="_05-结构体"><a href="#_05-结构体" class="header-anchor">#</a> 05 结构体</h3> <p>有时我们需要将不同类型的数据组合成一个整体，在Java中我们直接使用Java对象的属性，在Go中就可以使用结构体（和C类似）。结构体的定义语法为：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	id <span class="token builtin">int</span> <span class="token comment">//结构体成员前没有var关键字</span>
	name <span class="token builtin">string</span>
	sex <span class="token builtin">byte</span>
	age <span class="token builtin">int</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>有了上面的定义后我们就可以在函数中使用结构体并进行初始化：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//顺序初始化，每个成员必须初始化</span>
	<span class="token keyword">var</span> s1 Student <span class="token operator">=</span> Student<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;s1 = &quot;</span><span class="token punctuation">,</span> s1<span class="token punctuation">)</span>

	<span class="token comment">//指定成员初始化，没有初始化的自动赋值为0</span>
	s2 <span class="token operator">:=</span> Student<span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;s2 = &quot;</span><span class="token punctuation">,</span> s2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>涉及到指针操作时，和上面提到的无异：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> p1 <span class="token operator">*</span>Student <span class="token operator">=</span> <span class="token operator">&amp;</span>Student<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;s1 = &quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>p1<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>操作结构体的成员时，要使用<code>.</code>运算符：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> s Student
	s<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span>
	s<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;mike&quot;</span>
	s<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'f'</span>
	s<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">19</span>

	<span class="token comment">//通过指针来操作成员时，p.id和(*p).id完全等价</span>
	<span class="token keyword">var</span> p <span class="token operator">*</span>Student
	p <span class="token operator">=</span> <span class="token operator">&amp;</span>s
	p<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">2</span>
	<span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'m'</span>
	p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">20</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Student info:&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>p<span class="token punctuation">)</span>

	<span class="token comment">//也可以通过new来申请一块内存创建结构体</span>
	p2 <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>Student<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>类似于数组，结构体也是可以比较和赋值的，当然前提是必须要是同类型的结构体，并且只能比较相等和不相等。</p> <p>结构体直接作为函数参数传递时是值传递，针对形参的修改不能对实参产生影响。如果使用指针作为参数即可对实参进行修改（地址传递/引用传递）。</p> <p>值得注意的是，跨包使用结构体时需要使用<code>包名.结构体名</code>的方式来使用，并且结构体名称的首字母需要大写、成员名称首字母也需要大写（小写的话跨包就不可见了）。</p> <h2 id="第四章-实现面向对象特性"><a href="#第四章-实现面向对象特性" class="header-anchor">#</a> 第四章 实现面向对象特性</h2> <p>Go虽然<strong>简洁优雅</strong>地支持了面向对象编程，但是它并没有沿袭传统面向对象编程中的诸多概念，例如封装继承多态，Go语言通过别的方式实现这些特性：</p> <ul><li>封装：通过方法实现</li> <li>继承：通过匿名字段实现</li> <li>多态：通过接口实现</li></ul> <h3 id="_01-匿名组合-继承"><a href="#_01-匿名组合-继承" class="header-anchor">#</a> 01 匿名组合（继承）</h3> <p>一、关于结构体匿名字段，来看一下这个例子：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//人</span>
<span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
	sex <span class="token builtin">byte</span>
	age <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//学生</span>
<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Person <span class="token comment">//匿名字段，只有类型没有名字。学生包含了人的所有字段，实现了继承</span>
	id <span class="token builtin">int</span>
	addr <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">//我们来使用学生结构体</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//顺序初始化</span>
	<span class="token keyword">var</span> s1 Student <span class="token operator">=</span> Student<span class="token punctuation">{</span>Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;nanjing&quot;</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;s1: %+v\n&quot;</span><span class="token punctuation">,</span> s1<span class="token punctuation">)</span>

	<span class="token comment">//也可以指定成员初始化</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>如果要使用匿名字段中的成员，直接使用即可：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>sex<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>age<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>id<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>addr<span class="token punctuation">)</span>
	s1<span class="token punctuation">.</span>Person <span class="token operator">=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;judy&quot;</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">}</span>
	s1<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果在匿名组合的两个结构体间有同名字段，则默认采用就近原则，除非显式调用（例如s.Person.name）。</p> <p>二、关于非结构体匿名字段，看下面的例子：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> mystr <span class="token builtin">string</span>
<span class="token comment">//人</span>
<span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
	sex <span class="token builtin">byte</span>
	age <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//学生</span>
<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Person 
	<span class="token builtin">int</span>
	mystr
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	s <span class="token operator">:=</span> Student<span class="token punctuation">{</span>Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token string">&quot;haha&quot;</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>age<span class="token punctuation">,</span> s<span class="token punctuation">.</span>sex<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>mystr<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>只能做顺序初始化，没法指定匿名成员初始化。</p> <p>另外，指针类型也可以作为结构体的成员，初始化的时候取对应类型变量的地址或使用new()即可：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token operator">*</span>Person
	id <span class="token builtin">int</span>
	addr <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> s2 Student
	<span class="token comment">//s1 := Student{&amp;Person{&quot;wallace&quot;, 'm', 18}, 22, &quot;nanjing&quot;}</span>
	s2<span class="token punctuation">.</span>Person <span class="token operator">=</span> <span class="token function">new</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span> <span class="token comment">//注意不是s2.*Person</span>
	s2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;wallace&quot;</span>
	s2<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'m'</span>
	s2<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">18</span>
	s2<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">22</span>
	s2<span class="token punctuation">.</span>addr <span class="token operator">=</span> <span class="token string">&quot;nanjing&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_02-方法-封装"><a href="#_02-方法-封装" class="header-anchor">#</a> 02 方法（封装）</h3> <p>我们有了结构体和匿名字段之后可以表示对象的属性，但对象有时还需要对外提供可以操作的方法（或者说接口）。和普通函数不同，在定义方法时还需要在函数名前加上要绑定的类型。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> myint <span class="token builtin">int</span>

<span class="token comment">//这里的obj叫做接收者，接收者就是传递的一个参数</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>obj myint<span class="token punctuation">)</span> <span class="token function">Add</span><span class="token punctuation">(</span>num myint<span class="token punctuation">)</span> myint <span class="token punctuation">{</span> <span class="token comment">//这时myint类型的对象就有了这样的方法</span>
	<span class="token keyword">return</span> obj <span class="token operator">+</span> num
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a myint <span class="token operator">=</span> <span class="token number">2</span>
	result <span class="token operator">:=</span> a<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;result = &quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>这里我认为类似于Java反射包中Method类的invoke(Object obj, Object... args)方法，针对某种方法传入所需类型的对象以及需要的参数。</p> <p>从Go的角度出发，面向对象实质上是换了一种表示形式。上面的例子中我们只是对重定义的基本类型（类似于Java中的包装类型）绑定了方法，当然我们可以为结构体类型绑定方法，如果要修改结构体则是为结构体指针类型绑定方法。例子：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
	sex <span class="token builtin">byte</span>
	age <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//值传递，只是一份拷贝</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p Person<span class="token punctuation">)</span> <span class="token function">ShowInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Person info:&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//引用传递，可以修改</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>Person<span class="token punctuation">)</span> <span class="token function">SetInfo</span><span class="token punctuation">(</span>n <span class="token builtin">string</span><span class="token punctuation">,</span> s <span class="token builtin">byte</span><span class="token punctuation">,</span> a <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	p<span class="token punctuation">.</span>name <span class="token operator">=</span> n
	p<span class="token punctuation">.</span>sex <span class="token operator">=</span> s
	p<span class="token punctuation">.</span>age <span class="token operator">=</span> a
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	p1 <span class="token operator">:=</span> Person<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>
	p1<span class="token punctuation">.</span><span class="token function">ShowInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">var</span> p2 Person
	<span class="token punctuation">(</span><span class="token operator">&amp;</span>p2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetInfo</span><span class="token punctuation">(</span><span class="token string">&quot;wallace&quot;</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
	p2<span class="token punctuation">.</span><span class="token function">ShowInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>注意，可以给任意自定义类型（基本类型、结构体）添加方法，但如果自定义的类型本身就是指针类型那么就不能添加方法。</p> <p>一个类型的方法集指的是可以被该类型的值所调用的所有的方法的集合。不过，同一个类型的实例value和指针pointer调用方法时不受方法集的约束，编译器会查找全部方法并自动转换。例如上面的代码中使用<code>p1.SetInfo(&quot;wallace&quot;, 'm', 20)</code>和<code>(&amp;p2).ShowInfo()</code>都是可以的。</p> <p>方法的继承：在前面的例子中，Student继承了Person，加入我们有绑定Person类型的方法<code>func (p *Person) ShowInfo(){}</code>，那么Student类型的变量也可以调用这个方法，这就是方法的继承。</p> <p>方法的重写：如果Student类型也绑定了一个同名同参数的方法<code>func (p *Student) ShowInfo(){}</code>，那么这就是方法的重写，或者说覆盖。那么通过<code>s.ShowInfo()</code>调用的根据就近原则就会优先调用重写的方法。此外，可以显示地通过<code>s.Person.ShowInfo()</code>来调用继承的方法。</p> <p>小技巧，使用<strong>方法值</strong>保存方法的入口地址，可以在调用方法时无需再传递接收者更为简便：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	pFunc <span class="token operator">:=</span> p<span class="token punctuation">.</span>ShowInfo <span class="token comment">//没有括号，保存了方法的入口地址</span>
	<span class="token function">pFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//等价于p.ShowInfo()</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>方法表达式</strong>：方法值是隐藏了接收者，而方法表达式则是直接通过类型调用其绑定的方法：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	p <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span>
	f <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token operator">*</span>Person<span class="token punctuation">)</span><span class="token punctuation">.</span>SetInfo <span class="token comment">//没有括号，保存类型入口</span>
	<span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token comment">//显式地把接收者传递过去</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_03-接口-多态"><a href="#_03-接口-多态" class="header-anchor">#</a> 03 接口（多态）</h3> <p>在Go中接口有以下特点：</p> <ul><li>接口命名习惯以er结尾</li> <li>接口只有方法声明，没有实现，没有数据字段</li> <li>接口可以匿名嵌入其它接口，或者嵌入到结构中</li></ul> <p>示例：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Manner <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
	id <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Teacher <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
	id <span class="token builtin">int</span>
	division <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Student<span class="token punctuation">)</span> <span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;My name is: &quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Teacher<span class="token punctuation">)</span> <span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;My name is: %s, my division number is: %d\n&quot;</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>name<span class="token punctuation">,</span> t<span class="token punctuation">.</span>division<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//定义接口类型的变量，只要是实现了此接口方法的类型，那么这个类型的变量就可以给i赋值</span>
	<span class="token keyword">var</span> i Manner

	s <span class="token operator">:=</span> <span class="token operator">&amp;</span>Student<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">}</span>
	i <span class="token operator">=</span> s
	i<span class="token punctuation">.</span><span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	t <span class="token operator">:=</span> <span class="token operator">&amp;</span>Teacher<span class="token punctuation">{</span><span class="token string">&quot;judy&quot;</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
	i <span class="token operator">=</span> t
	i<span class="token punctuation">.</span><span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token function">ShowManner</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	<span class="token function">ShowManner</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>

	x <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>Manner<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
	x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> s
	x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> t
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> implementation <span class="token operator">:=</span> <span class="token keyword">range</span> x <span class="token punctuation">{</span>
		implementation<span class="token punctuation">.</span><span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">ShowManner</span><span class="token punctuation">(</span>i Manner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//some codes..</span>
	i<span class="token punctuation">.</span><span class="token function">SayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p>上面的程序中，Student和Teacher都实现了接口Manner中的方法，那么接口类型变量i就可以被赋值为两者的实例。如果我们编写的函数的参数中有接口类型，那么根据传入的接口实例的不同就会有不同的表现，这就是多态的一种体现。</p> <p>接口的嵌入（继承）：和结构体中的匿名字段一样，接口中也可以匿名嵌入另一个接口以实现继承。被继承的接口称为子集接口，继承之的接口称为超集接口。</p> <p>实现了超集接口的变量可以转换为子集接口的变量，反之则不可以。这一点符合面向对象设计原则中的里氏代换原则。</p> <p>空接口：空接口中不包含任何方法，因此所有类型都实现了空接口，从而空接口类型的变量可以存储任意类型的数值。如果我们需要函数可以接受任意类型的对象实例时，我们会将其声明为interface{}，最典型的是标准库中Print系列的函数：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">Printf</span><span class="token punctuation">(</span>fmt <span class="token builtin">string</span><span class="token punctuation">,</span> args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果我们由于需要得使用空接口，但又要在使用具体数据时要知道其类型，可以通过if或者switch实现断言。例：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	i <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
	i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
	i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span>
	i<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> Student<span class="token punctuation">{</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">}</span>

	<span class="token comment">//类型查询，类型断言</span>
	<span class="token keyword">for</span> index<span class="token punctuation">,</span> data <span class="token operator">:=</span> <span class="token keyword">range</span> i <span class="token punctuation">{</span>
		<span class="token comment">//第一个返回值是接口变量本身，第二个返回值是判断结果的真假</span>
		<span class="token keyword">if</span> value<span class="token punctuation">,</span> ok <span class="token operator">:=</span> data<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;x[%d]类型为int，内容为%d\n&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> value<span class="token punctuation">,</span> ok <span class="token operator">:=</span> data<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token punctuation">{</span>
			<span class="token comment">//...</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">//...</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">for</span> index<span class="token punctuation">,</span> data <span class="token operator">:=</span> <span class="token keyword">range</span> i <span class="token punctuation">{</span>
		<span class="token keyword">switch</span> value <span class="token operator">:=</span> data<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">case</span> <span class="token builtin">int</span> <span class="token punctuation">:</span>
				fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;x[%d]类型为int，内容为%d\n&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
			<span class="token keyword">case</span> <span class="token builtin">string</span><span class="token punctuation">:</span>
				<span class="token comment">//...</span>
			
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="第五章-异常、文本文件处理"><a href="#第五章-异常、文本文件处理" class="header-anchor">#</a> 第五章 异常、文本文件处理</h2> <h3 id="_01-error接口、panic、recover"><a href="#_01-error接口、panic、recover" class="header-anchor">#</a> 01 error接口、panic、recover</h3> <p>一、创建error：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;errors&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> err1 <span class="token builtin">error</span> <span class="token operator">=</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;%s&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;this is a normal error!&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err1<span class="token punctuation">)</span>

	err2 <span class="token operator">:=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;this is error 2&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>实际的例子，使用error来避免错误：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">Div</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>result <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	err <span class="token operator">=</span> <span class="token boolean">nil</span>
	<span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		err <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;分母不能为0！&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		result <span class="token operator">=</span> a <span class="token operator">/</span> b
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	result<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">Div</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;result = &quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>二、panic。Go中的error类似于Java中的Exception，panic类似于Java中的Error。当panic发生时（例如数组越界或空指针），程序会中断运行并立即执行该goroutine中被defer延迟的函数，随后程序崩溃并输出日志信息。</p> <p>在少数情况下我们会显式调用<code>panic(&quot;message&quot;)</code>函数来触发panic。</p> <p>三、recover。panic会导致程序崩溃，有时候我们不希望程序崩溃，那么就可以使用recover。recover必须要在被defer延迟调用的函数中才有效。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">testRecover</span><span class="token punctuation">(</span>x <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> err <span class="token operator">:=</span> <span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">var</span> a <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token builtin">int</span>
	a<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">123</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">testRecover</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
	<span class="token function">testRecover</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_02-字符串处理"><a href="#_02-字符串处理" class="header-anchor">#</a> 02 字符串处理</h3> <p>strings包中有很多有用的字符串处理相关的函数，实现了分割、拼接、寻找子串等功能，我们直接根据例子来看一下：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;strings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//Contains查找是否包含子串</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>strings<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;hellogo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//true</span>

	<span class="token comment">//Joins组合切片中所有的字符串</span>
	words <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">}</span>
	buf <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Joins</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span> <span class="token comment">//使用冒号作为分隔符</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span>

	<span class="token comment">//Index查看子串的开始位置</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>strings<span class="token punctuation">.</span><span class="token function">Index</span><span class="token punctuation">(</span><span class="token string">&quot;abcdhello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//4，不存在则返回-1</span>

	<span class="token comment">//Repeat重复拼接字符串</span>
	buf <span class="token operator">=</span> strings<span class="token punctuation">.</span><span class="token function">Repeat</span><span class="token punctuation">(</span><span class="token string">&quot;go&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">//&quot;gogogo&quot;</span>

	<span class="token comment">//Split以指定的分割符拆分字符串成一个切片</span>
	words2 <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">&quot;o&quot;</span><span class="token punctuation">)</span>

	<span class="token comment">//Trim去掉字符串首尾指定的字符</span>
	buf <span class="token operator">=</span> strings<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token string">&quot;   R U OK   &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span>

	<span class="token comment">//Fields去掉空格，把元素放入切片中</span>
	words3 <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Fields</span><span class="token punctuation">(</span><span class="token string">&quot;   R U OK   &quot;</span><span class="token punctuation">)</span> <span class="token comment">//得到切片[&quot;R&quot;, &quot;U&quot;, &quot;OK&quot;]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>strconv包提供了字符串转换相关的函数，我们来看一些例子：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;strconv&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//转换为字符串后追加到字节数组</span>
	slice <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span>
	slice <span class="token operator">=</span> strconv<span class="token punctuation">.</span><span class="token function">AppendBool</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
	slice <span class="token operator">=</span> strconv<span class="token punctuation">.</span><span class="token function">AppendInt</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token number">1234</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>以<span class="token number">10</span>进制格式添加<span class="token number">1234</span>
	slice <span class="token operator">=</span> strconv<span class="token punctuation">.</span><span class="token function">AppendQuote</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;slice = &quot;</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>slice<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//转换成string后再打印</span>

	<span class="token comment">//其他类型转换为字符串</span>
	<span class="token keyword">var</span> str <span class="token builtin">string</span>
	str <span class="token operator">=</span> strconv<span class="token punctuation">.</span><span class="token function">FormatBool</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
	str <span class="token operator">=</span> strconv<span class="token punctuation">.</span><span class="token function">FormatFloat</span><span class="token punctuation">(</span><span class="token number">3.14</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token comment">//打印格式以小数方式，float64，紧缩模式</span>
	str <span class="token operator">=</span> strconv<span class="token punctuation">.</span><span class="token function">Itoa</span><span class="token punctuation">(</span><span class="token number">666</span><span class="token punctuation">)</span> <span class="token comment">//整形转字符串</span>

	<span class="token keyword">if</span> flag<span class="token punctuation">,</span> err <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">ParseBool</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;flag = &quot;</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err = &quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	a<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">Atoi</span><span class="token punctuation">(</span><span class="token string">&quot;567&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a = &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="_03-正则表达式"><a href="#_03-正则表达式" class="header-anchor">#</a> 03 正则表达式</h3> <p>正则表达式是一种进行模式匹配和文本操纵的强大工具，Go语言通过regexp标准包实现了对正则表达式的支持。采用RE2语法，和多数语言基本一致，关于正则表达式具体的用法这里就不展开了。示例：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;regexp&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	buf <span class="token operator">:=</span> <span class="token string">&quot;abc  axc tac&quot;</span>

	<span class="token comment">//1) 编译规则，编译成功则返回*Regexp类型的变量（解释器），失败则触发panic返回空</span>
	reg1 <span class="token operator">:=</span> regexp<span class="token punctuation">.</span><span class="token function">MustCompile</span><span class="token punctuation">(</span><span class="token string">`a.c`</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> reg1 <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//2) 根据规则提取关键信息</span>
	result1 <span class="token operator">:=</span> reg1<span class="token punctuation">.</span><span class="token function">FindAllStringSubmatch</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token comment">/*要找出的数量，-1表示找到所有满足的*/</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;result1 = &quot;</span><span class="token punctuation">,</span> result1<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>正则表达式的处理效率没有strings包提供的字符串处理函数效率高，简单的字符串处理尽量使用strings包的函数，有复杂的需求再使用regexp包。</p> <h3 id="_04-json处理"><a href="#_04-json处理" class="header-anchor">#</a> 04 JSON处理</h3> <p>JSON（JavaScript Object Notation）是一种比XML更轻量级的数据交换格式，是一种理想的跨平台跨语言的数据交换语言，我们可以在www.json.cn上测试自己的JSON。Go语言通过内置的&quot;encoding/json&quot;包实现JSON的生成（编码）与解析（解码）。</p> <p>一、通过结构体生成JSON：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;encoding/json&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> INFO <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Company <span class="token builtin">string</span>
	Subjects <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
	Isok <span class="token builtin">bool</span>
	Price <span class="token builtin">float64</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	s <span class="token operator">:=</span> INFO<span class="token punctuation">{</span><span class="token string">&quot;SEU&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;Java&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Python&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Go&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">666.66</span><span class="token punctuation">}</span>

	<span class="token comment">//编码，根据内容生成JSON文本</span>
	buf<span class="token punctuation">,</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>

	<span class="token comment">//为了让最后看起来的结果有缩进便于阅读，编码时还可以使用另一个接口，参数分别为空串和Tab字符</span>
	<span class="token comment">//buf, err := json.MarshalIndent(s, &quot;&quot;, &quot;	&quot;)</span>

	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err = &quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//需要转成字符串，否则打印的是ASCII码</span>
	
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>注意，为了能让结构体被json包使用，结构体成员名的首字母必须大写，如果想要让编码后的对应首字母小写，可以使用struct tag声明：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> INFO <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Company <span class="token builtin">string</span> <span class="token string">`json:&quot;-&quot;`</span> <span class="token comment">//此字段不会输出</span>
	Subjects <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token string">`json:&quot;subjects&quot;`</span> <span class="token comment">//二次编码为小写</span>
	Isok <span class="token builtin">bool</span> <span class="token string">`json:&quot;,string&quot;`</span> <span class="token comment">//转换成字符串类型再编码</span>
	Price <span class="token builtin">float64</span> <span class="token string">`json:&quot;,string&quot;`</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>二、通过map生成JSON：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//创建map</span>
	m <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
	m<span class="token punctuation">[</span><span class="token string">&quot;company&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;SEU&quot;</span>
	m<span class="token punctuation">[</span><span class="token string">&quot;subjects&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;Java&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Python&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Go&quot;</span><span class="token punctuation">}</span>
	m<span class="token punctuation">[</span><span class="token string">&quot;isok&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
	m<span class="token punctuation">[</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">666.66</span>

	<span class="token comment">//编码成JSON</span>
	result<span class="token punctuation">,</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err = &quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>三、JSON解析到结构体：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	jsonbuf <span class="token operator">:=</span> <span class="token string">`...`</span><span class="token comment">/*JSON文本*/</span>
	<span class="token keyword">var</span> obj INFO
	err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>jsonbuf<span class="token punctuation">)</span><span class="token comment">/*先转为字节数组*/</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>obj<span class="token comment">/*地址传递才能写入*/</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;obj: &quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>如果只想解析部分字段，那么可以再定义一个只有需要的字段的结构体，再解析。这样只会解析需要的字段到结构体中。</p> <p>四、JSON解析到map：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	jsonbuf <span class="token operator">:=</span> <span class="token string">`...`</span><span class="token comment">/*JSON文本*/</span>
	m <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
	err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>jsonbuf<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;m: %+v\n&quot;</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span>

	<span class="token comment">//类型断言</span>
	<span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> m <span class="token punctuation">{</span>
		<span class="token keyword">switch</span> data <span class="token operator">:=</span> value<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">case</span> <span class="token builtin">string</span><span class="token punctuation">:</span>
				fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;map[%s]的value类型为string，value为：%s\n&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
			<span class="token keyword">case</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
				fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;map[%s]的value类型为bool，value为：%v\n&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
			<span class="token keyword">case</span> <span class="token builtin">float64</span><span class="token punctuation">:</span>
				fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;map[%s]的value类型为float64，value为：%v\n&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
			<span class="token keyword">case</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">:</span>
				fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;map[%s]的value类型为[]interface{}，value为：%v\n&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>由于map使用的是万能指针，所以实际解析完之后想要使用map中的数据还需要使用类型断言才可以；而解析到结构体中由于类型已经确定所以使用起来更简单。</p> <h3 id="_05-文件操作"><a href="#_05-文件操作" class="header-anchor">#</a> 05 文件操作</h3> <p>文件操作需要用到os包。</p> <p>一、建立与打开文件:</p> <p>可通过下面两个函数新建文件或覆盖原有文件：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//根据文件名创建，返回文件对象（默认权限0666）和是否有错误，调用了OpenFile()</span>
<span class="token keyword">func</span> <span class="token function">Create</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>file <span class="token operator">*</span>File<span class="token punctuation">,</span> err Error<span class="token punctuation">)</span>

<span class="token comment">//根据文件描述符创建相应文件，返回文件对象</span>
<span class="token keyword">func</span> <span class="token function">NewFile</span><span class="token punctuation">(</span>fd <span class="token builtin">uintptr</span><span class="token punctuation">,</span> name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">*</span>File
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>通过下面两个函数来打开文件：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">Open</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>file <span class="token operator">*</span>File<span class="token punctuation">,</span> err Error<span class="token punctuation">)</span> <span class="token comment">//实际上调用了OpenFile()</span>

<span class="token comment">//flag是打开方式，perm是权限permission</span>
<span class="token keyword">func</span> <span class="token function">OpenFile</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span> flag <span class="token builtin">int</span><span class="token punctuation">,</span> perm <span class="token builtin">uint32</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>file <span class="token operator">*</span>File<span class="token punctuation">,</span> err Error<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>二、读写文件：</p> <p>当我们通过上面的方法拿到File对象（指针）后就可以进行文件的读写操作了。下面是文件类型绑定的方法：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//1.写文件</span>
<span class="token comment">//将字节切片写入到文件</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>file <span class="token operator">*</span>File<span class="token punctuation">)</span> <span class="token function">Write</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err Error<span class="token punctuation">)</span>
<span class="token comment">//在指定偏移处写入字节类型的信息</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>file <span class="token operator">*</span>File<span class="token punctuation">)</span> <span class="token function">WriteAt</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> off <span class="token builtin">int64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err Error<span class="token punctuation">)</span>
<span class="token comment">//写入string类型的信息到文件</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>file <span class="token operator">*</span>File<span class="token punctuation">)</span> <span class="token function">WriteString</span><span class="token punctuation">(</span>s <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>ret <span class="token builtin">int</span><span class="token punctuation">,</span> err Error<span class="token punctuation">)</span>

<span class="token comment">//2.读文件</span>
<span class="token comment">//读文件到字节切片中</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>file <span class="token operator">*</span>File<span class="token punctuation">)</span> <span class="token function">Read</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err Error<span class="token punctuation">)</span>
<span class="token comment">//从指定位置读</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>file <span class="token operator">*</span>File<span class="token punctuation">)</span> <span class="token function">ReadAt</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> off <span class="token builtin">int64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err Error<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>记得使用完文件之后需要通过file.Close()将文件资源关闭，或者defer之。</p> <p>三、借助bufio包实现按行读取内容。由于上面使用os包自带的读写函数是直接操作字节数据，在读取文本文件时可以使用带缓冲的IO：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;os&quot;</span>
	<span class="token string">&quot;io&quot;</span>
	<span class="token string">&quot;bufio&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">ReadFileByLine</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	f<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">defer</span> f<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment">//通过reader读缓冲区中的内容</span>
	reader <span class="token operator">:=</span> bufio<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		buf<span class="token punctuation">,</span> err <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">ReadBytes</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span> <span class="token comment">//遇到行尾结束读取，包括读取'\n'</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> err <span class="token operator">==</span> io<span class="token punctuation">.</span>EOF <span class="token punctuation">{</span>
				<span class="token keyword">break</span>
			<span class="token punctuation">}</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;该行内容为: %s&quot;</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="第六章-并发编程"><a href="#第六章-并发编程" class="header-anchor">#</a> 第六章 并发编程</h2> <h3 id="_01-概述"><a href="#_01-概述" class="header-anchor">#</a> 01 概述</h3> <p>说一个很常见的问题：并行与并发的区别。并行（parallel）指的是：同一微观时刻有多条指令在多个处理器（内核）上执行；并发（concurrent）指的是同一时刻一个处理器上只能有一条指令在执行，但多个任务队列交替使用该处理器，在宏观上显得是多任务同时执行。</p> <p>Go语言在语言层面就支持了并发。其相关的API是基于CSP（communicating sequential processes，顺序通信进程）模型，这意味着显式的锁是可以避免的，从而简化了程序的编写。</p> <h3 id="_02-goroutine"><a href="#_02-goroutine" class="header-anchor">#</a> 02 goroutine</h3> <p>goroutine（协程）是比线程更小的单位，十几个goroutine可能体现在操作系统底层就是五六个线程，Go语言内部实现了goroutine之间的内存共享，执行之只需要极少的栈内存。</p> <p>程序启动时，其主函数main在一个单独的goroutine中运行，称为main goroutine。示例：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">newTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;This is a new task.&quot;</span><span class="token punctuation">)</span>
		time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">go</span> <span class="token function">newTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//新建携程执行该任务，之后主协程继续往下执行</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//也可以调用匿名函数</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;This is main goroutine.&quot;</span><span class="token punctuation">)</span>
		time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//主协程退出时，其他子协程也要跟着退出</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>由于主协程退出时，其他子协程也要跟着退出，所以开发者要注意不要让子协程还没来得及运行主协程就退出。</p> <p><strong>runtime包的一些重要函数：</strong></p> <p>runtime.Gosched()用于让出CPU时间片，使得调度器安排其他等待中的任务运行，并再下次某个时候从该位置恢复执行。（类似于Java中Thread类中的yield()方法）</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;go&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token comment">//如果不作处理的话主goroutine先执行，执行完毕后退出，导致子协程来不及执行</span>
		runtime<span class="token punctuation">.</span><span class="token function">Gosched</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>runtime.Goexit()将立即终止当前goroutine执行，调度器会确保所有以通过defer注册的延迟调用被执行。</p> <p>runtime.GOMAXPROCS(n int)用来设置可以并行计算的CPU内核数的最大值，参数为指定的内核数，返回值为总共的内核数。</p> <h3 id="_03-channel"><a href="#_03-channel" class="header-anchor">#</a> 03 channel</h3> <p>并发编程中一个常见的问题是资源竞争问题，为此需要一定的同步机制。<strong>goroutine奉行通过通信来共享内存（和同步），而不是共享内存来通信。</strong></p> <p>引用类型channel是CSP模式的具体实现，用于goroutine通讯，其内部实现了同步，确保并发安全。和map类似，channel也是通过make创建的对于底层数据结构的引用。channel传参是引用传递，创建方式：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> Type<span class="token punctuation">)</span> <span class="token comment">//Type可以是int、string等任意类型，无缓冲区</span>
<span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> Type<span class="token punctuation">,</span> capacity<span class="token punctuation">)</span> <span class="token comment">//指定缓冲区容量，如果为0则和上面等价</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>channel通过操作符<code>&lt;-</code>来接收和发送数据，语法为：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>channel <span class="token operator">&lt;-</span> value <span class="token comment">//发送value到channel</span>
<span class="token operator">&lt;-</span> channel <span class="token comment">//接收并将其丢弃</span>
x <span class="token operator">:=</span> <span class="token operator">&lt;-</span> channel <span class="token comment">//接收channel中的数据并赋值给x</span>
x<span class="token punctuation">,</span> ok <span class="token operator">:=</span> <span class="token operator">&lt;-</span> channel <span class="token comment">//功能同上，同时检查通道是否已关闭或者是否为空</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>无缓冲区的channel默认是阻塞的，只有向其中发送了内容后才能从中接收数据。</p> <p>示例，两个人使用打印机，我们想让user1执行完之后user2才能使用打印机：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> ch <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>

<span class="token comment">//公共资源打印机</span>
<span class="token keyword">func</span> <span class="token function">Printer</span><span class="token punctuation">(</span>str <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> data <span class="token operator">:=</span> <span class="token keyword">range</span> str <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%c&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
		time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">user1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">Printer</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
	ch <span class="token operator">&lt;-</span> <span class="token number">0</span> <span class="token comment">//向管道发送数据</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">user2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token operator">&lt;-</span> ch <span class="token comment">//从管道取数据，如果没有数据该goroutine就会阻塞</span>
	<span class="token function">Printer</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">go</span> <span class="token function">user1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">user2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		<span class="token comment">//不让主进程结束的死循环</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>无缓存的channel是同步的，会阻塞到发送者准备好和接收者也准备好。</p> <p>有缓存的通道是异步的，通道空时，接收者被阻塞；通道满时，发送者被阻塞。</p> <p>不需要再写数据时，可以通过<code>close(ch)</code>来关闭channel，这时<code>x, ok := &lt;- ch</code>得到的ok值就为false，那么读数据的进程就可以检查到管道关闭。关闭channel之后再向其发送数据会导致panic。</p> <p>除了在循环中检测ok状态来确定是否结束循环外，还有一个简单的方法可以在管道关闭时结束循环：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> num <span class="token operator">:=</span> <span class="token keyword">range</span> ch <span class="token punctuation">{</span> <span class="token comment">//channel关闭时会自动跳出循环</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;num = &quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>单向管道，指定管道只用于读或只用于写：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> ch1 <span class="token keyword">chan</span><span class="token operator">&lt;-</span> <span class="token builtin">int</span> <span class="token comment">//只能用于写入int类型的数据，不能读</span>
<span class="token keyword">var</span> ch2 <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token builtin">int</span> <span class="token comment">//只能从中读int类型数据，不能写</span>

<span class="token comment">//双向channel可以隐式转换为单向，单向channel无法转为双向</span>
<span class="token keyword">var</span> ch3 <span class="token keyword">chan</span><span class="token operator">&lt;-</span> <span class="token builtin">int</span> <span class="token operator">=</span> ch
<span class="token keyword">var</span> ch4 <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token builtin">int</span> <span class="token operator">=</span> ch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>单向channel的应用：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//参数表示传入的管道只能写</span>
<span class="token keyword">func</span> <span class="token function">producer</span><span class="token punctuation">(</span>out <span class="token keyword">chan</span><span class="token operator">&lt;-</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		out <span class="token operator">&lt;-</span> i <span class="token operator">*</span> i
	<span class="token punctuation">}</span>
	<span class="token function">close</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//只能读</span>
<span class="token keyword">func</span> <span class="token function">consumer</span><span class="token punctuation">(</span>in <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> num <span class="token operator">:=</span> <span class="token keyword">range</span> in <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;num = &quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ch <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>

	<span class="token comment">//生产者</span>
	<span class="token keyword">go</span> <span class="token function">producer</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token comment">//channel传参时引用传递</span>

	<span class="token comment">//消费者</span>
	<span class="token keyword">go</span> <span class="token function">consumer</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span>

	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>time包中提供了单次定时器timer的功能，可以帮助控制时间：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//创建定时器，设置时间为2s，两秒后会自动向timer.C这个channel中写入当前时间</span>
	timer <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">NewTimer</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	t <span class="token operator">:=</span> <span class="token operator">&lt;-</span>timer<span class="token punctuation">.</span>C
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>

	<span class="token comment">//也可以通过&lt;-time.After(2 * time.Second)定时产生事件</span>
	timer<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//停止定时器</span>
	ok <span class="token operator">:=</span> timer<span class="token punctuation">.</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>time包中提供了循环定时器ticker：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ticker <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">NewTicker</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>

	i <span class="token operator">:=</span> <span class="token number">0</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		<span class="token operator">&lt;-</span>ticker<span class="token punctuation">.</span>C

		i<span class="token operator">++</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;i = &quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>

		<span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">5</span> <span class="token punctuation">{</span>
			ticker<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token keyword">break</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_04-select"><a href="#_04-select" class="header-anchor">#</a> 04 select</h3> <p>Go提供了关键字select，通过select可以监听channel上的数据流动。select的用法和switch有些类似，但select最大的一条限制就是其下的case语句里必须是一个IO操作：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">select</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token operator">&lt;-</span> chan1<span class="token punctuation">:</span>
		<span class="token comment">//如果成功从chan1读取到数据，则执行该语句</span>
	<span class="token keyword">case</span> chan2 <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token punctuation">:</span>
		<span class="token comment">//如果成功向chan2写入了1，则执行该语句</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
		<span class="token comment">//如果上面都没有成功，则进入默认处理流程</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>select会按顺序评估有没有语句可以成功执行，如果没有任意一条语句可以执行（所有都被阻塞）那么这时：1）如果给出了default语句则执行之；2）如果没有给出default语句则select语句将被阻塞，直到至少有一个通信可以进行下去。</p> <p>如果多个语句都可以执行，那么会选择任意一个执行（不是按照代码中的顺序）。</p> <p>例子，通过select实现斐波那契数列：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>ch <span class="token keyword">chan</span><span class="token operator">&lt;-</span> <span class="token builtin">int</span><span class="token punctuation">,</span> canQuit <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	x<span class="token punctuation">,</span> y <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		<span class="token comment">//监听数据流动</span>
		<span class="token keyword">select</span> <span class="token punctuation">{</span>
			<span class="token keyword">case</span> ch <span class="token operator">&lt;-</span> x<span class="token punctuation">:</span>
				x<span class="token punctuation">,</span> y <span class="token operator">:=</span> y<span class="token punctuation">,</span> x <span class="token operator">+</span> y
			<span class="token keyword">case</span> flag <span class="token operator">:=</span> <span class="token operator">&lt;-</span> canQuit<span class="token punctuation">:</span>
				fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;flag:&quot;</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span>
				<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ch <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token comment">//通信的内容是整数</span>
	canQuit <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token comment">//传递程序是否结束</span>

	<span class="token comment">//消费者协程，从channel读取内容</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span> <span class="token comment">//从channel中读出8个整数后停止</span>
			num <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		canQuit <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token function">fibonacci</span><span class="token punctuation">(</span>ch<span class="token punctuation">,</span> canQuit<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>有时会出现goroutine长时间阻塞的情况，为了避免这种情况可以用select来设置超时处理：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ch <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
	canQuit <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>

	<span class="token comment">//新开协程不停检测</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">{</span>
			<span class="token keyword">select</span> <span class="token punctuation">{</span>
				<span class="token keyword">case</span> num <span class="token operator">:=</span> <span class="token operator">&lt;-</span> ch<span class="token punctuation">:</span>
					fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;num = &quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>
				<span class="token keyword">case</span> <span class="token operator">&lt;-</span> time<span class="token punctuation">.</span><span class="token function">After</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">:</span>
					fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;超时&quot;</span><span class="token punctuation">)</span>
					canQuit <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		ch <span class="token operator">&lt;-</span> i
		time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token operator">&lt;-</span>canQuit <span class="token comment">//超时退出前主协程都会阻塞</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;程序结束&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="第七章-socket编程"><a href="#第七章-socket编程" class="header-anchor">#</a> 第七章 Socket编程</h2> <h3 id="_01-socket编程"><a href="#_01-socket编程" class="header-anchor">#</a> 01 Socket编程</h3> <p>Socket起源于UNIX，UNIX哲学是一切皆文件，都可以用打开-&gt;读写-&gt;关闭的模式来操作。Socket是该模式的一种实现，也是一种文件描述符。Socket有一个类似于打开文件的函数调用Socket()，该函数返回一个整形的Socket描述符。常用的Socket类型有两种，流式（SOCKET_STREAM）和数据包式（SOCKET_SGRAM），分别对应TCP和UDP协议。</p> <p>例子：TCP服务器编写</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;net&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">handleConn</span><span class="token punctuation">(</span>conn net<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	buf <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span>
	n<span class="token punctuation">,</span> err1 <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err1 <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err1: &quot;</span><span class="token punctuation">,</span> err1<span class="token punctuation">)</span>
		<span class="token keyword">continue</span>
	<span class="token punctuation">}</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;buf: &quot;</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token punctuation">:</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//监听</span>
	listener<span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">&quot;tcp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;127.0.0.1:8000&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err: &quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">defer</span> listener<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment">//等待用户连接</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		conn<span class="token punctuation">,</span> err <span class="token operator">:=</span> listener<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//未连接时会阻塞</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err: &quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
			<span class="token keyword">continue</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">go</span> <span class="token function">handleConn</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>TCP客户端编写：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;net&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	conn<span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">&quot;tcp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;127.0.0.1:8000&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">defer</span> conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	conn<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;R U OK?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_02-案例-并发的聊天室服务器"><a href="#_02-案例-并发的聊天室服务器" class="header-anchor">#</a> 02 案例：并发的聊天室服务器</h3> <h2 id="第八章-http编程"><a href="#第八章-http编程" class="header-anchor">#</a> 第八章 HTTP编程</h2> <h3 id="_01-web工作方式"><a href="#_01-web工作方式" class="header-anchor">#</a> 01 Web工作方式</h3> <h3 id="_02-http报文格式"><a href="#_02-http报文格式" class="header-anchor">#</a> 02 HTTP报文格式</h3> <h3 id="_03-http编程"><a href="#_03-http编程" class="header-anchor">#</a> 03 HTTP编程</h3> <h3 id="_04-案例-网络爬虫"><a href="#_04-案例-网络爬虫" class="header-anchor">#</a> 04 案例：网络爬虫</h3></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2021/3/5 22:17:41</span></div></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      我是Wallace欢迎你的关注 
    </div> <div class="operation" style="right:90px;bottom:40px;display:none;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:none;" data-v-5775ee02></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div></div></div>
    <script src="/assets/js/app.c3dada13.js" defer></script><script src="/assets/js/3.113ae115.js" defer></script><script src="/assets/js/1.24f57cb6.js" defer></script><script src="/assets/js/13.23b7834b.js" defer></script>
  </body>
</html>
